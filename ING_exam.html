<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ING</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}.container{max-width:900px;margin:0 auto;background:white;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden}.header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:30px;text-align:center}.student-info{display:grid;gap:15px;padding:20px;background:#f8f9fa}input{width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em}input:focus{outline:none;border-color:#667eea}.btn{padding:12px 30px;border:none;border-radius:8px;font-size:1em;font-weight:600;cursor:pointer;transition:all 0.3s;margin:10px}.btn-primary{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white}.btn-success{background:#28a745;color:white}.btn-danger{background:#dc3545;color:white}.btn-warning{background:#ffc107;color:#000}.question{padding:25px;border-bottom:2px solid #e0e0e0}.question-number{font-size:1.2em;font-weight:bold;color:#667eea;margin-bottom:15px}.question-text{font-size:1.1em;margin-bottom:20px;line-height:1.6}.question-image{max-width:100%;border-radius:8px;margin:15px 0}.question-audio{margin:15px 0;padding:15px;background:#f8f9fa;border-radius:8px}audio{width:100%}.options{display:grid;gap:12px}.option{padding:15px;border:2px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all 0.3s;display:flex;align-items:center;gap:12px}.option:hover{background:#f8f9ff;border-color:#667eea}.option.selected{background:#e8f5e9;border-color:#28a745}.option input[type="checkbox"]{width:20px;height:20px;cursor:pointer}.timer{position:fixed;top:20px;right:20px;background:white;padding:15px 25px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.2);font-size:1.5em;font-weight:bold;z-index:1000}.timer.warning{background:#ffc107;color:#000}.timer.danger{background:#dc3545;color:white;animation:pulse 1s infinite}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}.result{display:none;padding:30px;text-align:center}.result.active{display:block}.score{font-size:3em;font-weight:bold;color:#28a745;margin:20px 0}.qr-container{margin:30px auto;padding:20px;background:#f8f9fa;border-radius:12px;max-width:400px}#exam{display:none}#exam.active{display:block}#result{display:none}#result.active{display:block}.manual-data{background:#f8f9fa;padding:15px;border-radius:8px;margin-top:15px;word-break:break-all;font-family:monospace;font-size:0.9em}.controls{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:white;padding:15px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.2);display:flex;gap:10px;z-index:1000}.question-nav{display:flex;flex-wrap:wrap;gap:8px;padding:20px;background:#f8f9fa;border-radius:8px;margin:20px 0}.nav-btn{padding:10px 15px;border:2px solid #e0e0e0;background:white;border-radius:6px;cursor:pointer;font-weight:600;transition:all 0.3s}.nav-btn:hover{background:#667eea;color:white;border-color:#667eea}.nav-btn.answered{background:#28a745;color:white;border-color:#28a745}.nav-btn.doubt{background:#ffc107;color:#000;border-color:#ffc107}.nav-btn.active{border-color:#667eea;border-width:3px}#passwordPrompt{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:2000;justify-content:center;align-items:center}#passwordPrompt.active{display:flex}.password-dialog{background:white;padding:40px;border-radius:16px;max-width:500px;width:90%;text-align:center}.password-input{width:100%;padding:15px;border:2px solid #e0e0e0;border-radius:8px;font-size:1.1em;margin:20px 0}.password-error{color:#dc3545;margin-top:10px;display:none}#review{display:none;padding:30px}.review-header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:30px;border-radius:12px;margin-bottom:30px;text-align:center}.review-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:20px}.review-stat{background:rgba(255,255,255,0.2);padding:20px;border-radius:8px}.review-stat-value{font-size:2.5em;font-weight:bold}.review-question{background:white;padding:25px;margin-bottom:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}.review-question.correct{border-left:5px solid #28a745}.review-question.wrong{border-left:5px solid #dc3545}.review-q-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.review-q-number{font-size:1.3em;font-weight:bold;color:#667eea}.review-badge{padding:8px 16px;border-radius:20px;font-weight:bold;font-size:0.9em}.review-badge.correct{background:#d4edda;color:#155724}.review-badge.wrong{background:#f8d7da;color:#721c24}.review-q-text{font-size:1.1em;margin-bottom:15px;line-height:1.6}.review-q-img{max-width:100%;border-radius:8px;margin:15px 0}.review-q-audio{margin:15px 0;padding:15px;background:#f8f9fa;border-radius:8px}.review-q-audio-label{display:flex;align-items:center;gap:10px;font-weight:600;margin-bottom:10px}.review-options{display:grid;gap:10px;margin-top:15px}.review-option{padding:12px 15px;border-radius:8px;display:flex;align-items:center;gap:10px;background:#f8f9fa}.review-option.correct-answer{background:#d4edda;border-left:3px solid #28a745}.review-option.wrong-answer{background:#f8d7da;border-left:3px solid #dc3545}.review-opt-label{font-weight:bold;min-width:30px;color:#667eea}.review-indicator{font-size:1.2em}.answer-explanation{margin-top:15px;padding:15px;background:#fff3cd;border-left:3px solid #ffc107;border-radius:8px}.answer-explanation-title{display:flex;align-items:center;gap:10px;font-weight:bold;margin-bottom:10px;color:#856404}.answer-explanation-text{color:#856404;line-height:1.6}</style></head><body><div id="login" class="container"><div class="header"><h1>üìö ING</h1><p>‚è±Ô∏è Waktu: 2 menit | üìù Soal: 2</p></div><div class="student-info"><input type="text" id="studentName" placeholder="Nama Lengkap"><input type="text" id="studentNIS" placeholder="NIS"><input type="text" id="studentClass" placeholder="Kelas"><button class="btn btn-primary" onclick="startExam()">üöÄ Mulai Ujian</button></div></div><div id="exam"><div class="timer" id="timer">‚è±Ô∏è <span id="timeDisplay">00:00</span></div><div class="container"><div class="header"><h1>üìö ING</h1></div><div class="question-nav" id="questionNav"></div><div id="questions"></div><div class="controls"><button class="btn btn-warning" onclick="markDoubt()">‚ùì Ragu-ragu</button><button class="btn btn-danger" onclick="submitExam(false)">‚úÖ Selesai</button></div></div></div><div id="result"><div class="container"><div class="header"><h1>üéâ Hasil Ujian</h1></div><div class="result active"><div class="score" id="rScore">0</div><p style="font-size:1.3em;margin-bottom:30px">Nilai Anda</p><p><strong>Nama:</strong> <span id="rName"></span></p><p><strong>NIS:</strong> <span id="rNis"></span></p><div class="qr-container"><p style="font-weight:bold;margin-bottom:15px">üì± Scan QR Code untuk submit nilai:</p><div id="qrcode" style="display:flex;justify-content:center"></div><div class="manual-data"><strong>üìã Data Manual (jika QR tidak bisa di-scan):</strong><br><span id="manualData"></span></div></div><button class="btn btn-info" onclick="promptReviewPassword()">üìñ Lihat Pembahasan</button></div></div></div><div id="passwordPrompt"><div class="password-dialog"><h2>üîê Masukkan Password</h2><p style="margin:15px 0;color:#666">Password untuk melihat pembahasan soal</p><input type="password" class="password-input" id="reviewPasswordInput" placeholder="Masukkan password"><div class="password-error" id="passwordError"></div><div style="margin-top:20px"><button class="btn btn-primary" onclick="verifyPassword()">‚úÖ Verifikasi</button><button class="btn btn-danger" onclick="closePasswordPrompt()">‚ùå Batal</button></div></div></div><div id="review"><div class="container"><div class="review-header"><h1>üìñ Pembahasan Soal</h1><div class="review-stats"><div class="review-stat"><div class="review-stat-value" style="color:#28a745" id="reviewCorrect">0</div><div>Benar</div></div><div class="review-stat"><div class="review-stat-value" style="color:#dc3545" id="reviewWrong">0</div><div>Salah</div></div><div class="review-stat"><div class="review-stat-value" id="reviewScore">0</div><div>Nilai</div></div></div></div><div id="reviewContent"></div><div style="text-align:center;margin-top:30px"><button class="btn btn-primary" onclick="backToResult()">‚¨ÖÔ∏è Kembali ke Hasil</button></div></div></div><script>var WEB_APP_URL="https://script.google.com/macros/s/AKfycbwc1wTsKH2MVQLf2CFAOfhCuMSiCRJPbiGg9VGOMXFBKtMvltsSwHq1WThsNOLPE8FgDg/exec";var qs=[{"text":"1 + 1 =","options":{"A":"1","B":"2","C":"3","D":"4","E":"5"},"correctAnswers":["B"],"image":null,"audio":null,"type":"text"},{"text":"2 + 2 =","options":{"A":"1","B":"2","C":"3","D":"4","E":"5"},"correctAnswers":["D"],"image":null,"audio":null,"type":"text"}];var reviewPass="MTIz";var std={};var ans=[];var doubt=[];var currentQ=0;var timeLeft=120;var timer;var viols=0;var submitInProgress=false;var examResults=null;function sendToSpreadsheet(data){console.log("üì§ Mengirim data ke Google Sheets...",data);fetch(WEB_APP_URL,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(function(){console.log("‚úÖ Data berhasil dikirim ke Google Sheets");}).catch(function(err){console.error("‚ùå Error mengirim ke Sheets:",err);alert("‚ö†Ô∏è Gagal mengirim ke Google Sheets. Data tetap tersimpan di QR Code.");});}function startExam(){var n=document.getElementById("studentName").value.trim();var nis=document.getElementById("studentNIS").value.trim();var cls=document.getElementById("studentClass").value.trim();if(!n||!nis||!cls){alert("‚ùå Semua data harus diisi!");return}std={name:n,nis:nis,class:cls};for(var i=0;i<qs.length;i++){ans[i]=[];doubt[i]=false}document.getElementById("login").style.display="none";document.getElementById("exam").classList.add("active");renderQuestions();showQuestion(0);startTimer();try{document.documentElement.requestFullscreen()}catch(e){}}function renderQuestions(){var c=document.getElementById("questions");var n=document.getElementById("questionNav");c.innerHTML="";n.innerHTML="";for(var i=0;i<qs.length;i++){var q=qs[i];var d=document.createElement("div");d.className="question";d.id="q"+i;d.style.display=i===0?"block":"none";var audioHtml="";if(q.audio){audioHtml='<div class="question-audio"><p style="font-weight:600;margin-bottom:10px">üéµ Audio soal:</p><audio controls controlsList="nodownload"><source src="'+q.audio+'"></audio></div>'}var imgHtml="";if(q.image){imgHtml='<img src="'+q.image+'" class="question-image">'}d.innerHTML='<div class="question-number">Soal '+(i+1)+' dari '+qs.length+'</div>'+audioHtml+'<div class="question-text">'+escapeHtml(q.text)+'</div>'+imgHtml+'<div class="options" id="opts'+i+'"></div>';c.appendChild(d);var opts=document.getElementById("opts"+i);["A","B","C","D","E"].forEach(function(opt){var o=document.createElement("div");o.className="option";o.innerHTML='<input type="checkbox" id="q'+i+'_'+opt+'"><label for="q'+i+'_'+opt+'" style="cursor:pointer;flex:1">'+opt+'. '+escapeHtml(q.options[opt])+'</label>';o.onclick=function(e){if(e.target.tagName!=="INPUT"){document.getElementById("q"+i+"_"+opt).click()}};document.getElementById("q"+i+"_"+opt).onchange=function(){toggleAnswer(i,opt)};opts.appendChild(o)});var nb=document.createElement("button");nb.className="nav-btn";nb.textContent=i+1;nb.onclick=function(idx){return function(){showQuestion(idx)}}(i);n.appendChild(nb)}}function toggleAnswer(qIdx,opt){var idx=ans[qIdx].indexOf(opt);if(idx>-1){ans[qIdx].splice(idx,1)}else{ans[qIdx].push(opt)}updateNavButton(qIdx)}function updateNavButton(idx){var btns=document.querySelectorAll(".nav-btn");btns[idx].classList.remove("answered","doubt");if(doubt[idx]){btns[idx].classList.add("doubt")}else if(ans[idx].length>0){btns[idx].classList.add("answered")}}function showQuestion(idx){currentQ=idx;document.querySelectorAll(".question").forEach(function(q){q.style.display="none"});document.getElementById("q"+idx).style.display="block";document.querySelectorAll(".nav-btn").forEach(function(b,i){b.classList.remove("active");if(i===idx){b.classList.add("active")}});window.scrollTo({top:0,behavior:"smooth"})}function markDoubt(){doubt[currentQ]=!doubt[currentQ];updateNavButton(currentQ)}function startTimer(){timer=setInterval(function(){timeLeft--;var m=Math.floor(timeLeft/60);var s=timeLeft%60;document.getElementById("timeDisplay").textContent=pad(m)+":"+pad(s);var t=document.getElementById("timer");if(timeLeft<=300){t.classList.add("warning")}if(timeLeft<=60){t.classList.add("danger")}if(timeLeft<=0){clearInterval(timer);alert("‚è∞ Waktu habis! Ujian akan di-submit otomatis.");submitExam(true)}},1000)}function submitExam(auto){if(submitInProgress){return}submitInProgress=true;try{if(!auto){var unanswered=0;var doubtCount=0;for(var i=0;i<qs.length;i++){if(doubt[i]){doubtCount++}else if(!ans[i]||ans[i].length===0){unanswered++}}var msg="";if(unanswered>0){msg+="‚ö†Ô∏è Ada "+unanswered+" soal yang belum dijawab\n"}if(doubtCount>0){msg+="‚ùì Ada "+doubtCount+" soal yang masih ragu-ragu\n"}if(msg&&!confirm(msg+"\nYakin ingin submit ujian?")){submitInProgress=false;return}}if(timer){clearInterval(timer);timer=null}var cor=0;var results=[];for(var i=0;i<qs.length;i++){var q=qs[i];var sa=ans[i]||[];var ca=q.correctAnswers.slice();sa.sort();ca.sort();var isCorrect=JSON.stringify(sa)===JSON.stringify(ca);if(isCorrect){cor++}results.push({questionIndex:i,studentAnswer:sa,correctAnswer:ca,isCorrect:isCorrect})}examResults={studentAnswers:ans,results:results,correct:cor,total:qs.length};var sc=Math.round(cor/qs.length*100);var k="exam_1770081482455_"+std.nis;var dt=new Date();var ts=dt.getFullYear()+"-"+pad(dt.getMonth()+1)+"-"+pad(dt.getDate())+" "+pad(dt.getHours())+":"+pad(dt.getMinutes());var r={name:std.name,nis:std.nis,class:std.class,score:sc,correct:cor,total:qs.length,violations:viols,timestamp:ts,examTitle:"ING"};try{localStorage.setItem(k,JSON.stringify(r))}catch(e){console.error("Storage error:",e)}sendToSpreadsheet(r);document.getElementById("rName").textContent=std.name;document.getElementById("rNis").textContent=std.nis;document.getElementById("rScore").textContent=sc;var qrText="EXAM|"+std.nis+"|"+std.name+"|"+std.class+"|"+sc+"|"+cor+"|"+qs.length+"|"+viols+"|"+ts+"|ING";document.getElementById("manualData").textContent=qrText;try{document.getElementById("qrcode").innerHTML="";new QRCode(document.getElementById("qrcode"),{text:qrText,width:280,height:280,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.M})}catch(qrErr){console.error("QR Error:",qrErr);document.getElementById("qrcode").innerHTML="<p style=\"color:red;padding:20px\">‚ö†Ô∏è QR Code gagal dibuat.<br>Gunakan data manual di bawah.</p>"}document.getElementById("exam").style.display="none";document.getElementById("result").classList.add("active");if(document.fullscreenElement){try{document.exitFullscreen()}catch(e){}}submitInProgress=false}catch(err){alert("‚ö†Ô∏è Error saat submit: "+err.message+"\n\nSilakan screenshot hasil Anda dan hubungi guru.");console.error(err);submitInProgress=false}}function pad(n){return n<10?"0"+n:n}function promptReviewPassword(){document.getElementById("result").classList.remove("active");document.getElementById("passwordPrompt").classList.add("active");document.getElementById("reviewPasswordInput").value="";document.getElementById("passwordError").style.display="none";document.getElementById("reviewPasswordInput").focus()}function closePasswordPrompt(){document.getElementById("passwordPrompt").classList.remove("active");document.getElementById("result").classList.add("active")}function verifyPassword(){var input=document.getElementById("reviewPasswordInput").value.trim();if(!input){document.getElementById("passwordError").textContent="‚ùå Password tidak boleh kosong!";document.getElementById("passwordError").style.display="block";return}var encodedInput=btoa(input);if(encodedInput===reviewPass){document.getElementById("passwordPrompt").classList.remove("active");document.getElementById("review").style.display="block";generateReview();window.scrollTo({top:0,behavior:"smooth"})}else{document.getElementById("passwordError").textContent="‚ùå Password salah! Silakan coba lagi.";document.getElementById("passwordError").style.display="block";document.getElementById("reviewPasswordInput").value="";document.getElementById("reviewPasswordInput").focus()}}document.getElementById("reviewPasswordInput").addEventListener("keypress",function(e){if(e.key==="Enter"){verifyPassword()}});function backToResult(){document.getElementById("review").style.display="none";document.getElementById("result").classList.add("active");window.scrollTo({top:0,behavior:"smooth"})}function generateReview(){var correct=examResults.correct;var wrong=examResults.total-correct;var score=Math.round(correct/examResults.total*100);document.getElementById("reviewCorrect").textContent=correct;document.getElementById("reviewWrong").textContent=wrong;document.getElementById("reviewScore").textContent=score;var cont=document.getElementById("reviewContent");cont.innerHTML="";for(var i=0;i<qs.length;i++){var q=qs[i];var result=examResults.results[i];var studentAns=result.studentAnswer;var correctAns=result.correctAnswer;var isCorrect=result.isCorrect;var div=document.createElement("div");div.className="review-question "+(isCorrect?"correct":"wrong");var audioHtml="";if(q.audio){audioHtml='<div class="review-q-audio"><div class="review-q-audio-label"><span style="font-size:1.3em">üéµ</span><span>Audio soal:</span></div><audio controls controlsList="nodownload"><source src="'+q.audio+'"></audio></div>'}var imgHtml="";if(q.image){imgHtml='<img src="'+q.image+'" class="review-q-img">'}var optionsHtml="";["A","B","C","D","E"].forEach(function(opt){var isStudentAns=studentAns.indexOf(opt)!==-1;var isCorrectAns=correctAns.indexOf(opt)!==-1;var optClass="review-option";var indicator="";if(isCorrectAns){optClass+=" correct-answer";indicator='<span class="review-indicator">‚úÖ</span>'}if(isStudentAns&&!isCorrectAns){optClass+=" wrong-answer";indicator='<span class="review-indicator">‚ùå</span>'}if(isStudentAns&&!isCorrectAns){optionsHtml+='<div class="'+optClass+'"><span class="review-opt-label">'+opt+'.</span><span>'+escapeHtml(q.options[opt])+'</span>'+indicator+'<span style="margin-left:10px;font-size:0.9em;color:#dc3545">(Jawaban Anda)</span></div>'}else if(isCorrectAns){optionsHtml+='<div class="'+optClass+'"><span class="review-opt-label">'+opt+'.</span><span>'+escapeHtml(q.options[opt])+'</span>'+indicator+'<span style="margin-left:10px;font-size:0.9em;color:#28a745">(Jawaban Benar)</span></div>'}else if(isStudentAns){optionsHtml+='<div class="'+optClass+'"><span class="review-opt-label">'+opt+'.</span><span>'+escapeHtml(q.options[opt])+'</span></div>'}else{optionsHtml+='<div class="'+optClass+'"><span class="review-opt-label">'+opt+'.</span><span>'+escapeHtml(q.options[opt])+'</span></div>'}});var explanationHtml="";if(!isCorrect){var correctOptTexts=correctAns.map(function(opt){return opt+". "+q.options[opt]}).join(", ");explanationHtml='<div class="answer-explanation"><div class="answer-explanation-title"><span style="font-size:1.2em">üí°</span><span>Penjelasan:</span></div><div class="answer-explanation-text">Jawaban yang benar adalah: <strong>'+correctOptTexts+'</strong></div></div>'}div.innerHTML='<div class="review-q-header"><span class="review-q-number">Soal '+(i+1)+'</span><span class="review-badge '+(isCorrect?"correct":"wrong")+'">'+( isCorrect?"‚úÖ Benar":"‚ùå Salah")+'</span></div>'+audioHtml+'<div class="review-q-text">'+escapeHtml(q.text)+'</div>'+imgHtml+'<div class="review-options">'+optionsHtml+'</div>'+explanationHtml;cont.appendChild(div)}}function escapeHtml(t){var m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':'&quot;',"'":"&#039;"};return String(t).replace(/[&<>"']/g,function(c){return m[c]})}</script></body></html>